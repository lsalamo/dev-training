{"paragraphs":[{"text":"%pyspark\nfrom datetime import datetime, date, timedelta\ntimestamp_one_hour_seconds = 3600\ntoday = datetime.now().date()\nyesterday = date.today() - timedelta(days=1)\n\ntimestamp_today_seconds = int(today.strftime('%s'))\ntoday_milliseconds = (timestamp_today_seconds + timestamp_one_hour_seconds) * 1000\n\ntimestamp_yesterday_seconds = int(yesterday.strftime('%s'))\nyesterday_milliseconds = (timestamp_yesterday_seconds + timestamp_one_hour_seconds) * 1000\n\nprint datetime.utcfromtimestamp(float(today.strftime('%s')))\nprint timestamp_today_milliseconds\nprint timestamp_yesterday_milliseconds\n","user":"anonymous","dateUpdated":"2020-01-08T17:22:17+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576231639596_-1139791610","id":"20191213-110719_1644430201","dateCreated":"2019-12-13T11:07:19+0100","dateStarted":"2020-01-08T17:11:40+0100","dateFinished":"2020-01-08T17:11:40+0100","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9331"},{"text":"%pyspark\n#folders\nsource_ma_web = \"52iGcYgiMU\"\nsource_ma_android = \"Pav8CGEt3v\"\nsource_ma_ios = \"i9RX2dfz4J\"\n\ndataframe = spark.read.json(\"s3://data-sch-swamp-pro/dwh/apis/segment-logs/milanuncios/segment-logs/\" + source_ma_ios + \"/\"+ str(today_milliseconds))\ndataframe.registerTempTable(\"segment_events\")\ndataframe.printSchema()\n","user":"anonymous","dateUpdated":"2020-01-08T17:22:17+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-192-168-140-163.eu-west-1.compute.internal:4040/jobs/job?id=16","http://ip-192-168-140-163.eu-west-1.compute.internal:4040/jobs/job?id=16","http://ip-192-168-140-163.eu-west-1.compute.internal:4040/jobs/job?id=17","http://ip-192-168-140-163.eu-west-1.compute.internal:4040/jobs/job?id=17"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578498720455_-1746311322","id":"20200108-165200_1138638344","dateCreated":"2020-01-08T16:52:00+0100","dateStarted":"2020-01-08T17:11:43+0100","dateFinished":"2020-01-08T17:11:56+0100","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9332"},{"text":"%sql\n--select * from segment_events where event is null\n--select event, type, projectId, count(*) from segment_events where event is null group by event, type, projectId\n--select * from dfmil_luis where traits.userId =  'sdrn:milanuncios.com:user:202121273'\nselect type, event, count(*) from segment_events group by type, event\n","user":"anonymous","dateUpdated":"2020-01-08T17:22:17+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"type":"string","event":"string","count(1)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","tableHide":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578389364950_1130621801","id":"20200107-102924_1658509797","dateCreated":"2020-01-07T10:29:24+0100","dateStarted":"2020-01-07T12:16:50+0100","dateFinished":"2020-01-07T12:16:57+0100","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9333"}],"name":"Luis","id":"2EW6AFA67","noteParams":{},"noteForms":{},"angularObjects":{"python:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}